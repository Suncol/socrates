This USAGE file explains only the use of view2d with the two netCDF output
files generated by the SOCRATES model written at NCAR/ACD: 
one containing the diurnally averaged variables (e.g. "archive.nc") and 
one containing the diurnal variations of the chemical species 
(e.g. "diuvarch.nc").

Main window actions
-------------------

On the left of the graphics area are the action buttons, and the variables and
date lists. You can click on another variable or date on these lists, and get 
a new latitude-altitude contour plot of the selected variable at the selected 
date. By default, the levels of the contour are re-calculated for each new plot.
It is possible to keep the present levels for all contour plots.
Play with the "auto" and "fix" buttons of the "2D-levs" exclusive button group.

Two actions are possible in the graphics area showing the contour plot : 
- To know the precise value of a variable at fixed coordinates, simply click
on the desired point on the plot. A rectangle will show you the size
(resolution) of the data point, and the bottom line will display the value.
It is necessary to select a point in this way to have access to the
1-dimensional plots (the program needs to set the value along the fixed
dimension).
- To zoom on a smaller area of the contour plot, left-click on the first corner 
of the zoom, drag the mouse to the opposite corner while keeping the mouse 
button down, and release the mouse button on the opposite corner of the area
you want to zoom on. The 1-dimensionsal plots will have ranges limited to the 
area shown on the contour plot. To go back to a global view of the data, 
select "Unzoom" in the "Display" menu.
This pointing/zooming function has a bug, check the file "BUGS.txt".

Switch between the "Lin" and "Log" buttons of the "1D-axis" exclusive button
group to change the axes of the 1-dimensional plots (no effect on contour plots).

Switch between the "vmr" and "dens" buttons of the "Chem" exclusive button
group to display the chemical species either as volume mixing ratios or as 
number densities (molec/cm3), respectively. This feature is available only if 
the data file contains a "totdens" variable (total atmospheric number density) 
in units of "molec/cm3".

The data currently displayed is extracted from the "foreground" file. You can
close that file and open another one instead by clicking on the first "Open.."
button or selecting "File" menu, "Open new Fooreground file..."

Comparing two output files
--------------------------

You can compare the "foreground" file to a "background" file, another netCDF
file having the same variables. First open the background file (click on the
second "Open" button). If the variable currently selected is present in the
background file as well, you can plot the relative or absolute differences
between same variables from the two files by clicking respectively on the 
"(F-B)/B" or "F-B" button. The relative difference
plotted is (z1-z2)/z2 where z1 comes from the foreground file and z2 from the
background file. The program searches for a date in the background file as
close as possible to the one currently selected in the foreground file.

Another way to compare the same variable in the two files is to "Switch"
between them (foreground<->background). The contour plot is automatically 
updated. When a background file is opened, it does not appear on the contour
plot but it will appear in another color on the 1-dimensional plots.

1D-plots
--------

First select a point on the contour plot. Then, in the "1D-plot" menu, choose
"Vertical" or "Horizontal". You can switch between linear or logarithmic axes
by clicking on the "Lin" or "Log" buttons of the main window. The coordinate
axes will be limited to the zoom displayed on the contour plot.

Diurnal variations
------------------

The SOCRATES model can output the diurnal variations of the chemical species in
special netCDF files (e.g., "diuvarch.nc"). If you open such a file, you can 
plot the diurnal cycle of the desired species. First select a point on the
contour plot. Then, in the "1D-plots" menu, choose "Time-dependent", and either
"24 hour" or "48 hour". The "24 hour" plot will also display two vertical
dotted lines, corresponding to sunrise and sunset times.

Month-latitude plots
--------------------

If you open a netCDF file containing diurnal averages on a long enough time 
span (more than 6 dates archived), you can get "month-latitude" views through
the "2D-plots" menu. A typical application is the plotting of a "Dobson map",
showing the evolution in time of the total ozone column.
To get a "month-latitude" view at a fixed altitude, you must first select a
point at the desired altitude on the "latitude-altitude" (usual) contour plot.
If the variable currently selected is a chemical species (units of "vmr" or
"molec/cm3") you can also get a "month-latitude" view of the column, 
in molec/cm2, integrated over the altitude range shown on the latitude-altitude 
contour plot. Get the total column on all altitudes by selecting first 
"Display" menu, "Unzoom". If the variable is "o3", the new plot
will be automatically converted from "molec/cm2" to "Dobson units".

As for the usual contour plots, you can select a point or zoom to a smaller
part of the contour plot. From a "month-latitude" plot, you can also extract
a 1-dimensional plot of the evolution of a variable through the year, at a 
fixed latitude. Select "Horizontal" in the "1D-plots" menu.

To get back to the usual "latitude-altitude" view, click in the main window on
the variable or on the date list.

Printing your plots - exporting your plot to a file
---------------------------------------------------

!! NOTE !! The "Print..." command in the "File" menu is EXPERIMENTAL and does
NOT work well !! The effect of "Print..." and "Printer Setup" are 
machine-dependent and often poor, at least with IDL 5.1. The safest way to print 
a plot is to export it to a PostScript file (*.ps) as described below and to
print this file from outside of IDL.

In the "File" menu, choose "Export last plot to file...".
You will be prompted for a postscript filename.
!! The plot exported to PostScript will be the current 1D plot if there is a 1D
plot window on the screen. If there is none, the plot exported will be the
contour plot displayed in the graphics area of the main window !!
Sorry, I have not succeeded to get the PostScript printer to show the same
colors than on the screen. To export a B&W plot, first switch the
"Color/Nocolor" setting in the "Display" menu.

Writing the last plot to a PostScript file is performed by the routine 
"plot_to_file.pro". This routine is (relatively) easy to modify by the user,
it has lots of comments. That is the place to set the exported plot following 
your special needs (e.g. GIF file instead of PostScript, bigger fonts, Portrait
orientation instead of Landscape...)

Changing the textual and graphical elements displayed on the plots
------------------------------------------------------------------

Everything is in the "Display" menu. From there, you can change the texts 
appearing on the last plot ("Edit Texts..."). To go back to the texts generated
automatically, click on the variable name in the variable list or on the date
in the date list. The labels of the axes can be modified as well 
("Edit axes labels..."), but this is a permanent change for the current IDL
session.
You can also set what information is added to the plot or not, e.g. get rid of
the pressure axis, or suppress all texts together. Select "Show/not show..."
from the "Display" menu.

There are many other features in this IDL program. Explore by yourself and
Enjoy !
