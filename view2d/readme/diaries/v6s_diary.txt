              SOCRATES Version history from 18 october 2000
              ---------------------------------------------

Development based on v5s23, see myversions_v5.txt
Major difference with v5s is the new chemical routine chemdr.f around the chem
solver preprocessed.f . It now uses constant (latitude-independent) timesteps.

v6s01: CHEMDR, SOL_DAY and SETPHT changes - FAILS
-------------------------------------------------
SOL_DAY still calculates J at 2 afternoon midpoints. A 3rd point
is added for sunset with logj=-200. Spline interp tables are prepared. 
CHEMDR uses a constant timestep, and call SETPHT where the J are interpolated 
from the tables prepared by SOL_DAY. 
This makes the storing of nlon=8 chem values per day useless. Actually the new
time algorithm creates lat discontinuities of qn2da in mesosphere.
Removing chem_diavg.f, qn2da is directly accumulated in CHEMDR.
Removing chem_heat.f, chemheat is directly accumulated in new heat_rates.f, 
called by CHEMDR. Old heat_rate.f replaced by total_heat_rate.f, where srheat3
is calculated as SUM of chemheat.
Very nice chem results with dts in CHEMDR set to 25 mins. 
The lat discontinuities generated by the old nlon=8 storing scheme can still 
be seen in the solar heating output (will be fixed at v6s18).
Temperature problem: the winter tropopause temperature is lower, alhtough we 
still relax to Tmsis below 30km (mainsw(1)=1). q in v6s01 exhibits a minimum 
there which wasn't present in v5s22a.
Numerical Problem: when dts in CHEMDR is set <= 1200s (20min), floating
point exception in LU_FAC (preprocessed.f) after 4 sim days: lu( 43 ,426) = 0. 
divides itself.
Notice new polar night approx: polar_night when daylight length < 0.5hours 
(see SUN_POSITION).

v6s02: direct accumulation of solar heating rates
-------------------------------------------------
Removing SOL_HEAT_RATES, solheat (module HEAT_TERMS) now calculated in
HEAT_RATES (called inside CHEMDR), using interpolation of pshk calculated in
SOL_DAY (ie PHO_STAM), exactly as logjk is interpolated in SETPHT.
new qn2night (module SPECIES) stored in CHEMDR, for archiving only.
nlon qnd qn2 are ready to be removed altogether.
O3 totally wrong below 30km, due to OH (?) due to H2O which is complemetely 
wrong (in v6s01 & v6s02) because v6s modifs made Rashid's routines wrong.
Notice: lower strato O3 solheat is wrong -> T is wrong, although mainsw(1) is
set to 1 !? This is due to wrong H2O, which is an important input to HECOL 
(CMM1 heat) and creates such a bad pch/qcool that it modifies t2d in less time
than the relaxation time to MSIS = daypas = 5 days.

v6s03: fixing H2O, The big cleanup - WORKS but...
-------------------------------------------------
Removing variables nlon and qn2. Removing all heteogeneous chemistry and water
processes programmed by Rashid. Re-introducing minimal H2O tropo processes in
h2o_special.f, calculates the max h2o vmr in maxh2ovap (module BACKATM) and
applies it to qn2da(h2o), qn2noon(h2o).
Results: H2O is now OK. O3 column at equator drifts down rapidly.
Notice: the washout will have to be reintroduced somehow!!!

v6s04: simplified chemistry- WORKS but...
-----------------------------------------
Using preprocessor, a new chem reac & species list is used where all Cl, Br 
species are removed, including CFC etc. The JPL2000 update of JPL97 is lost in 
the process. Notice: when the species/reac list is changed, the mapping var 
"map" in PHO_STAM must be modified. Look at diff_v6s03.v6s04 to see other modifs
when a new chem scheme is implemented.
Results compared w/v6s03: O3 much bigger below 60km, as expected. O3 column does
not drift. Most results seem acceptable above 60km, especially temperature is 
OK. Mesospheric O3 solheat has lat discontinuities (will be fixed at v6s18).

v6s05: extra chem tsteps around sunrise & sunset - WORKS but...
---------------------------------------------------------------
SETPHT & HEAT_RATES: the night test does not depend on sza_first_light any more,
but on the corresponding scszak(nk). This fixes the numerical problem in LU_FAC 
for small tsteps, described at v6s01.
The chem tstep algorithm is enhanced: We keep the cst tsteps, identical at all
lats, and add "nextra" tsteps around sunset and "nextra" tsteps around sunrise,
as specified in "chemdtm", part of control_parms input namelist.
The new vector "slt" at which chem will be calc is pre-computed in the greatly
extended SUN_POSITION, which uses new sorting routine HPSORT in numerical.mod.f.
All new vars are in module CHEM_TIMES, chem.mod.f .
Module SPECIES now contains qn2se & qn2ss where sunrise & sunset vals are stored
in CHEMDR. Re-updating to JPL2000.
Results seem good, but meso O3 solheat still has lat discont 
(will be fixed at v6s18), and O3-night between 60 & 80 km depends a lot 
on time resolution.

v6s06: bug w/extra tsteps fixed; full chem; diuvar ASCII output - WORKS but...
------------------------------------------------------------------------------
Found bug in v6s05 causing bad time resolution dependency: nt, slt, sltsr and
sltss computed in SUN_POSITION must be explicitly lat-dependent since calc is
done only for iday=1 inside the main lat loop. Corrected CHEMDR & SUN_POSITION.
Reverted to v6s03 (ie v5s19) full chem scheme.
Implemented diurnal variations ASCII output, set in input namelist io_parms by
dvoutsw & ran_dvout (& ldaig, zdiag). New routine DIAGS_DV_INIT, output to
dvout.dat. Discovered that the implicit chem solver is very imprecise between 
70 & 85km: results with dt=1hr very different than with dt=3min. This is due to
the numerical method of the solver, not to a bug (see thesis).
3-year run: crashes (no chem convergence) after 3months if dt=2hr.
Run v6s06, with dt=1hr: no crash. Costs 7.4CPUhr/SimYr (from 3.5hr in v5s
series). Very smooth chem heating, but meso O3 sol heating shows lat discont
(will be fixed at v6s18). 
Problem: O3 column going down, WASHOUT needs to be re-introduced.
Global avg of meso T lower than MSIS. Sunrise values at equator not stored.
Time evolution of Solheat, Chemheat at 100km is quite irregular: there is still
a bug. Notice in v5s22a we had this already for ChemHeat but not for SolHeat.

v6s07: chemical lifetime output
-------------------------------
Module SPECIES (chem.mod.f) has tau_noon and tau_night, which CHEMDR 
sets = 1 / loss_rate which is now output by IMP_SLV (preproc/imp_slv.F 
modified). preproc/socpp.v6s07.cray.in has better J labelling.
Families in archive.f are now complete.
Learning from v6s08 below, changed the criteria & the correction used in 
IMP_SLV (preprocessed.f) when the new nb densities are very low or negative:
cls_dens set to zero where < 1e-99, and cvg criteria satisfied where cls_dens
is < 1e-9. Notice the second criteria *must* be easier to fulfill than the first
(1e-9>1e-99).

v6s08: Attempting to use simple EBI solver - WORKS but MUCH TOO SLOW
--------------------------------------------------------------------
... using the prods & losses calculated by IMP_PROD_LOSS. See SOCRATES notebook,
30/11/2000. Had to change the criteria in IMP_SLV when the new dens is very low:
see v6s07 above. Integration does not crash only if chemdts <= 60s, requires too
many iterations, this is much too slow. 10-d run: results *very* similar to 
v6s06, but 10days take 6 CPU hours!! 
Modified src/preprocessed.f (but not the preprocessor itself!) to re-calc only
those species which have not converged yet, 10 days now take 3.54 hours.
That sub-version is lost. In versions/fails/v6s08a.tar.gz, there is a failed
version with this cvgce per species, but also a new night test. 
v6s08b works. Modif to CHAPMAN and all routines calling it: it now
takes again cos(sza), not sec(sza), since sec(sza) could be infinite.
Greatly enhanced DIAGS_CHEM in case of non-convergence. Optimizations:
COS_SZA now saves last latitude and declination angle which is re-calc only if
lat changed. SETPHT calculates scsza, now sent back as output to CHEMDR which 
sends it as input to HEAT_RATES, where COS_SZA and CHAPMAN are removed.
Notice the results at sunset, sunrise and midnight are not stored correectly 
(values close to noon are stored instead).

v6s09: Reverting to usual solver, better CHEM controls - WORKS
--------------------------------------------------------------
All enhancements from v6s07 & v6s08 re-used. One now sets separately chemdtm 
(default, max), nextra and extradtm. Storage of sunrise & sunset values fixed.
3-yr run: results identical to v6s09, except O3 & OH night values just next to
polar day limit. Run takes 7.7 CPUhr/SimYr (+/- =v6s06). 

v6s10: re-introducing WASHOUT - WORKS FINE
------------------------------------------
Re-introducing washout.f, which calls modified SATVAPP in h2o_special.f .
Results: no trends in total ozone or ozone species any more, the annual cycle 
stabilises in 3 years.

v6s11: Replaced CH4+hv->H2 bu CH4+hv->CH3O2+H - WORKS FINE
----------------------------------------------------------
Only CH3O2, CH2O, CH3OOH are modified a lot. H2O, CH4, H2 do not change much.

v6s12: Introducing o2dg & o2s photochemistry - WORKS FINE
---------------------------------------------------------
New routine mlynczak93.pho.f, new preprocessed.*, modified socpp source code
because there was a bug: the rates in SETRXT were set only once if they
were constant, but could be multiplied every 5 days by totdens or n(N2) if the
corresponding reaction has M or N2 as agent! This had no ill effect up to
v6s11 but is fixed now.
Enhanced archiving: arch_level=2 for UBAIM netCDF output by new routine 
arch_ubaim.f . See e-mail to Jan Kazil, 10 jan 2001, and his reply, 22 jan 2001.

v6s13: New global change chemistry switches - changed arch - PRODUCT RUNS
-------------------------------------------------------------------------
Introduced gcc_sw(1) & gcc_sw(2) for double CO2 & CH4, see switches.txt, 
describe_sim.f, boundy.f & main.f . Modified arch_heat.f & arch_small.f .
Control run v6s13, sensitivity runs v6s13a (2*CO2) & v6s13b (2*CH4) .

v6s14: Changed input of CCM1 (tropo_heat) and its use - WORKS
-------------------------------------------------------------
Input to NCAR CCM1 tropo heat (main routine hecol.f) was done in datain.f,
completely wrong: no ocean, zero clouds, constant albedo!!
Setting clouds density ccv to 15% in lower half of tropo and 5% in upper half.
Changing other (ocean/land, ice, snow) flags and albedo in DATAIN.
Setting cloud density has the biggest effect, cools the tropopause down.
DATAIN had length of daylight set to 24h. Extracted new fct DAY_LENGTH from
routine SUN_POSITION. This new fct called from SECJOU, SUN_POSITION, COS_SZA,
BOUNDY. SECJOU totally re-written, now called only from HECOL.

v6s15: Removed CCM1 (tropo_heat) altogether - WORKS
---------------------------------------------------
see file ccm1_trashed.txt which justifies removal of CCM1 param of tropo 
heating/cooling rates (hecol.f, rad.mod.f and child files)
Much better tropo results. All T problems (in tropo, strato, meso) in polar 
regions. Tried re-tuning of PW param (dynf_pwave, routine WBOUND): useless.

v6s16: J(NO) fixed, SPECIAL_NO_PROD - WORKS
-------------------------------------------
- Fixed bug in PHO code: at v5s12, maxden (phot.mod.f) was decreased from 6 to 4 
and dens(:,4) was set to NO2 i.o. NO, thinking NO & CO2 were not used,
looking at ABSDEP. NO was actually used by minsch93.pho.f to calc J(NO). It uses 
dens(:,4) which is now NO2! Setting maxden to 5 (in phot.mod.f renamed
pho.mod.f), dens(:,4) set to NO again in PHO_STAM, ABSEDP corrected to use
dens(:,5). Effect (v6s16_3yr.heat.nc vs. v6s15a_1yr.heat.nc, solmin) is big only
for NO, only above 60km, in polar *night* during solstice, max reldiff=40% !??
v6s16a: Special NO productions enhanced & grouped in new SPECIAL_NO_PROD, 
contains unchanged LIGHTNING and COSMIC where fixed very old bug (was lat-dep 
but calc lat fcts if .not. entered). Both can be switched off with mlt_sw(4)<0. ).
NOYION split into contained AURORA(pio_e->paur) and SOFTXRAY(pio_hv->phve_no).
See SOCRATES textbook, 7 Feb 2001. BOUNDY: flxub(NO) changed, set to zero if
mlt_sw(4) < 1!
v6s13b: by setting mlt_sw(4)=0, removing *all* thermospheric NO, including the
NO which was coming from flxub. Comparing v6s13b w/ v6s13a: notice huge effect 
of aurora NO on lower mesospheric O3 in polar night.
v6s16c: adjusting mlt_NO calc w/mlt_sw(4)=2 to CIRA96 (Barth-1996,Fig.2)
results: divided paur & phve_no by 4 in SPECIAL_PROD_NO; divided by 4 flxub(NO)
in boundy.f (from -4e8*td/24 to -1e8*td/24). Results compared w/v6s16a, March
1998: Peak at 110km, equator decreases from 7e8 to 2.4e7 molec/cm3; Peak at
110km, poles decreases from 13e7 to 4e7. CIRA96 has 4e7 at poles (OK) and 1e7 at
equator.

v6s17: changed SOLCYCLES setup, fixed solar bugs - PRODUCT RUNS
---------------------------------------------------------------
routine AURORA in SPECIAL_NO_PROD: factor f was not initialized to zero outside
of polar regions. This causes errors in v6s16c of 10% for NO, 5% for O3.
Fixed bug in PHO_INIT to get solmin & solmax from solavg & solvar: 0.25->0.5 .
Changed totally the solar cycles values (see thesis, subs-meso11obs) & switches 
(see switches_v6s17.txt) in SOLCYCLES and SPECIAL_PROD_NO (now influenced by 
solar cycle), which now calcs flxub(NO).
Product runs are v6s17_10yr (SOLMIN), v6s17a_10yr (SOLMAX-NO) and v6s17b_10yr 
(SOLMAX+NO) discussed in thesis, ref{subs-meso11eq}

v6s18: changed ARCHIVE setup, fixed solheat bug
-----------------------------------------------
New global real parameter, the "missing value", missval in module SIM_CONTROLS.
New arch_chem.f; archive.f moved to arch_full.f; new ARCHIVE chooses between
the 5 types of archives using arch_type (replaces arch_level).
Results strictly identical to v6s17.

v6s19: init to missing value, changed SETPHT & sol HEAT_RATES algorithm
-----------------------------------------------------------------------
Common initialization instructions for archives put in ARCHIVE_INIT which now
defines the missing value missval. Enhanced routine SET_ATTRIBUTE (module 
NETCDF_UTILS, file nf_utils.mod.f) can now get a real value.
Lots of vars in chem.mod.f, dynam.mod.f, heat.mod.f, pho.mod.f have their
initial values set to missval. gwheat & qn2noon *must* be initialized to 0.
Removed entirely the 'nlon' global parameter & modules PMC, PSC (dynam.mod.f).
Fixed bug in SOL_DAY: when calling SPLINE for pshkd2, use i, not jproc!
But solheat then becomes negative!! 
Changed SETPHT & HEAT_RATES: for times between noon & ki=1, logj & psh are set 
to logjk(ki=1) & pshk(ki=1).
HEAT_RATES now performs a *linear* interpolation on the *log* of presolheat.
The spline interp is unreliable (results can be < 0), and using the log removes
the lat discontinuities in meso O3 solheat seen since v6s01. The solheat also
decrease by +-20% (!). T results different, T lower up to 7K in polar day.
v6s19a: linear interp for J (SETPHT) also. O3 results different, especially near
        terminator. O3 profiles seem better with spline interp,and linear interp
        takes 3* more time, increasong total CPU time by 60% !! Reverting to
        SPLINT interp in SETPHT at v6s20.
v6s19a_test2: trying daypas=1., small differences, especially in deep in polar 
              day. Nothing important.
v6s19a_test3: keeping daypas=1, in pho.mod.f trying nd=16->nd2=8->nk=9, better
              time resolaution for J & solheat. Small differences, especially 
              near limit of polar day. Reverting to nd=4.

v6s20
-----
main.f: iday=1,daypas loop extended on whole code, so MSIS, ATMCOND & BOUNDY are
now called every day. Still calling TOTAL_HEAT_RATE only for iday=1 since
presolheat calculated only for iday=1.
Completely changed the archiving algorithm. Settings done through arch_set
(module ARCH_WHAT), new routine SET_ARCH processes them to calc new struc-var
arch (module ARCH_WHAT) used by ARCH_PLUG and ARCHIVE, which is totally
re-written. 7 different modes are possible, one run can write 7 different output
files: $label.basic.nc , $label.heat.nc, $label.chem.nc, $label.ubaim.nc,
$label.full.nc, $label.dvout.dat & $label.save.nc , each at its own sim dates.

v6s21: porting to aeolos (Compaq alphaserver GS160)
---------------------------------------------------
Small compil fixes (removed double declarations). 
Debug crashes with "ladebug socrates core", followed by "where".
sim_cont.mod.f, module TIMING: time%cal_day becomes real (from integer) 
since some routines used it as real and other as integer (did not crash on 
hal since int & reals take same memory). 
Debug compil on hal with -e i option -> had to initialize J vars in pho_stam.f 
& setpht.f. 
Segmentation fault on aeolos, wrong traceback with ladebug: found bug in INTERP
(numerical.mod.f): used logical dummy optional variable log io local variable
log_interp, WRONG when log is not passed at the call level, PLUS using "log" as
an optional dummy argument is a bad idea since it is an implicit function.
replaced dummy optional arg 'log' by 'on_log', and used local var 'log_interp'
everywhere in the code.
Renamed NC_READ_INIT to READ_SAVE_OLD.
DEC f90 compiler can not debug array boundaries in DYN_SOLVE, same as HP
compiler, see email from Stacy, Re: strcal_lb.f, 22 Sep 1999, and
hercules:/home/simonc/test/array_index.f
Checking array boundaries in POTTEMP: DEC f90 finds error at line
            aa(i-1,l) = -(xa + xb)
Indeed, for l=1, k=1 -> i = k - nl + 1 = 1 -> setting aa(0,1) ; aa is a pointer:
      aa => aam(1:nizz,1:lmax)
Check with Stacy !??
Fixed SETPHT to avoid overflow in CHAPMAN (test on sza > sza_first_light+10. ).

v6s22: updating & using cache version of preprocessed.f - PRODUCT runs
----------------------------------------------------------------------
i.e. hercules:/home/simonc/socrates/preproc/in/cache/imp_slv.F
v6s22.heat.nc: BEWARE: UVSOL-O2 & UV_SOL_O3 wrongly set at zero for most 
               dates except 1 per year

v6s29: Removing BUG which was depleting H2O at HLSM
---------------------------------------------------
Routine H2O_SPECIAL sets H2O to a max from condensation. Since strong GW in 
ARBITRARY_GW_DYN, T at polar day mesopause has become low enough to reach 
condensation -> PMC formation! But H2O never comes back -> endless sink -> total
H2O depletion in mesospheric polar day.
Limiting the altitude range of H2O ceiling set by H2O_SPECIAL to izm+10 where 
izm is tropopause altitude index. -> production runs u*.nc

v6s30: Relacing daypas by 1. permanently; re-tuning ARBITARY_GW_DRAG
--------------------------------------------------------------------
Tried daypas=1 in sensitivity test runs tp1 & up1. Compared run tp1 w/run t0b, 
or run up1 w/run u0b -> results are non-negligibly different, dt/dy becomes too
big. Removing daypas everywhere, replaced by 1. Removing iday, always=1
Adding mainsw(4)=-1 for ZERO Gw drag, Kzz as in default mainsw(4)=1 (ie by Hines
using HWM). Re-programming ARBITRARY_GW_DYN, much better time-dependency param,
with SQRT(cos(day)) during 2*nd days around summer solstice & -ABS(COS(day))
for rest of year around winter solstice. Better mesopause results especially 
at equinox. v6s30a: nd=51, v6s30b: nd=71, best probably in between.

v6s31: setting right params for molecular diffusion of H2, CH4, CO, CO2
-----------------------------------------------------------------------
The params A and s to calc D_i in VDIFF_NEW were set as unknown for these
species, although they're listed in Banks/Kockarts-chap15-1973 (tab.15.1,p.40).
Using this table. Differences are negligible for all but CO2, which increases by
15% in LT -> IRcool_CO2 increases -> mesopause cooler by 5K.

v6s32: Definitive version for thesis
------------------------------------
Generated all U*.nc result files for the thesis. Exec speed is 4.9 CPUhr/SimYr

v6s33: First trial to run on qbrick (SGI origin)
------------------------------------------------
Crashed because of bugs by which variables are uninitialized (these were set 
silently to 0 on aeolos).

v6s34: first working runs on qbrick
-----------------------------------
Several uninitialization bugs corrected. Still have to compile code with 
"-static" because some unitialization left in preprocessed.f .
v6s34: tested lowered UTLS transport w/ smaller min Kzz (dyn_main.f) and tropo 
Kzz ending 2km lower (tropk.f). Tropopause T less clean. Hoped to decrease H2O,
but after 3 years we see H2O *increasing* at 40 and 80 km compared w/ U0b !?
v6s34*.nc overwritten by run below.
v6s34: control run. Results slightly (0.1%) different than on aeolos. 
v6s34b: newer crs(H2O) from Cheng/et-al-1999, interpolated in new crs2002.dat
        H2O decresases by max 7% at stratopause-> slightly better but not much

v6s35: Fixed last problem for qbrick; nicer code: static_sim, qcorr
-------------------------------------------------------------------
Routine IMP_SLV in preprocessed.f: the vars lbase and base_sav must be 
initialized at zero, correction done in preproc/in/vector/imp_slv.F .
Almost zero difference w/v6s34b, but compilation doest not require the "-static"
switch any more -> exec speed is 7.6 CPUhr/SimYr
v6s35a: found out that u_hwm at surf is time-indep. Fixing u to u_hwm from
        0 to 2km, also more consistent with T(:,1:3)=Tmsis(:,1:3). 
        This setting of LBC is moved rom MAIN to DYN_U, modified to begin at 
        3km. No change w/v6s35.
v6s35b: - two time counters in MAIN: sim_time and phys_time, sim_time used for
        simulation loop and outputs, phys_time to compute forcings & MSIS/HWM, 
        sim_time=phys_time if new sim switch static_sim is .false. (default)
        - Changed formulation of pt_relax to Tmsis when mainsw(1)>0: now done in
        MAIN, at same time as damping by alpha*t2d, using qcorr=pt_relax*Tmsis.
        POTTEMP simplified, formulation mathematically identical to before.

v6s36: trying old (v4s17) LBC(chi) in DYN_SOLVE, by DWNCTRL
-----------------------------------------------------------
The main influence on tropo dyn is actually the LBC on chi, set in DYN_SOLVE.
Since v4s18, it is set by an arbitrary function with SINVAR on month of year.
The result is the always symmetrical Hadley cells. Here we re-introduce the
LBC(chi) used until v4s17, ie by DWCNTRL (contained now in DYN_SOLVE).
v6s36 has interactive T and u (as v6s35) and v6s36a uses u_hwm and Tmsis 
from 0 to 20km. The tropo dyn is *much* different, with non-centered Hadley 
cell(s) and generally weaker w. The effect on UTLS transport of tracers is 
difficult to understand: strato ch4 decreases as expected, but h2o *increases*
(opposite to expected effect) and tracer_x also!?

v6s37: reverting to usual LBC(chi); fixing UBC(ch4)
---------------------------------------------------
There was ch4 accumulation in polar night, as was the case for h2o. Fixing it by 
setting ubmr(:,vid_ch4) = 1.e-9 in BOUNDY. Reverting to usual xo=LBC(chi) in 
DYN_SOLVE (this LBC now computed in contained SINVAR_CHILBC_DYN).
v6s37a: tried divididing xo by 3: w gets 3* smaller at 2km, but the effect
decreases quickly with alt (almost same at 10km). Discarding result files.

v6s38: archiving improvements - used for GRL article
----------------------------------------------------
Mainly for dvout netcdf output. netcdf_utils.mod.f greatly enhanced: 
possibility to archive 2d-matrixes one col at a time.
This is the version used for GRL paper Chabrillat/et-al-2002.
The control run is labelled v6s38.
v6s38f: in vdiff_new.f, found vals for alphat(CO2,H2) in Bernhardt-1979(p.799).
Negligible differences, keeping v6s38 - v6s38e results for paper.
v6s38s: same source as v6s38f ; switches for Tmsis, ntot by MSIS, SOLMAX
to give output to Jan Kazil.

v6s39: test the distributed VDIFF ; test UBC(CO2)=40ppm
-------------------------------------------------------
Renamed VDIFF_NEW to VDIFF and modified it for general distribution.
Testing it, CHEMDR modified. Works fine, results identical to v6s38f.
Moving Hair calculation to VDIFF: after 15 days, small (<2%) differences.
v6s39a: CRISTA-1 obs (Kaufmann/et-al-2002) show much steeper vert grad
for CO2, even when decreasing Kzz in SOCRATES (see also Kaufmann's email, 
oct 2002) the UBC for CO2 *must* be changed, from flux=0, to the values 
measured by CRISTA at 110km (z*=120km): 40ppm. 
v6s39a test, comparing with v6s38f: globally averaged CO2 gets significantly 
smaller (F-B<-10ppm) only above 100km ; On Nov.7, 30°N (as CRISTA1 obs in PDF 
file emailed by Kaufmann, OcT 24,2002): the gradient is not so much changed,
vmr=250ppm at zgeo=100km (CRISTA-1 obs:+-120ppm).
So most of the change arises above mesopause. Winter mesopause gets too warm
(beacuse of CO2 decrease). I could try adjusting dyn F_GW, but I should rather
set UBC(CO2) as flux to get 40ppm in global avg, with different flux 
in polar night.

To-do list
==========
- Tuning dyn. and transport by looking at chem tracers i/o T: use H2O, CH4, N2O
  for uppert tropo & strato, tune Kzz. Brice has lots of CH4 data. Also use
  UARS monthly climato.
- Strato H2O takes 10 years to increase to values too big compared w/ 
  Nedoluha/et-al-1997. CH4 prod or transport through tropopause?. 
  Find some way to get better transport of H2O through the tropopause
  -> done through qtotl = d(clh)/dphi. If freezing is to be taken in account,
  notice that tropical tropopause is 9K too warm in MSIS (199K i.o. 190K in Zhou-et-al-2001).

- Use O(3P) for tuning transport at mesopause: is the max in polar night found using
  arbitrary GW true? Not in SOCRATES using Lindzen, neither in MSIS (or CIRA96 which 
  uses MSIS) - but the experimental sources for O by MSIS are unclear.
  SOCRATES using Hines gives an even bigger O max in polar night
- Try setting Cp = 1.005 J/g/k  (homospheric cst) in ATMCOND, in case my formula 
  is wrong - eg I forgot to put He and Ar in
- Check qcool by H2O (q2 in HEAT_IRCOOL). Lat avg vert profile is constant!?
  Removing q2 could lead to better T profile (compared w/MSIS), allowing to 
  remove chemheat from solheat as in Berger/vonZahn-1999
- Try using again and tuning the dyn forcing by tidal waves dissipation: 
  set mlt_sw(2)=1 by default, i.e. ftx /= 0. Current param gives Better mesopause 
  temperatures in the tropical regions but too cold mesosphere (zs=80km) there
- In order to get global lifetimes calculation, place accumulation of dens_acc 
  and loss_acc (using loss_out) in LIFETIMES_CHEM as was done in v5s23 by 
  ACC_LOSS (preprocessed.f)
- Create a separate routine for UBC where fluxes are calc from molecular diff
  formulas: see Kockarts-2000, p.98
